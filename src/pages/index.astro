---
const base = import.meta.env.BASE_URL;
const img = (path) => `${base}${path.replace(/^\/+/, "")}`;

const products = [
  {
    id: "set-black",
    name: "Black Satin-Look Cami & Shorts Set",
    price: 499,
    image: "/images/set-black.png",
    colors: ["Black"],
    sizes: ["S", "M", "L"],
  },
  {
    id: "set-white",
    name: "White Satin-Look Cami & Shorts Set",
    price: 499,
    image: "/images/set-white.png",
    colors: ["White"],
    sizes: ["S", "M", "L"],
  },
  {
    id: "nude-slip",
    name: "Nude Satin-Look Slip Dress",
    price: 499,
    image: "/images/nude-slipp-dress.png",
    colors: ["Nude"],
    sizes: ["S", "M", "L"],
  },
  {
    id: "white-slip",
    name: "White Satin-Look Slip Dress",
    price: 499,
    image: "/images/white-slip-dress.png",
    colors: ["White"],
    sizes: ["S", "M", "L"],
  },
  {
    id: "black-chemise",
    name: "Black Satin-Look Chemise Dress",
    price: 499,
    image: "/images/black-chemise.png",
    colors: ["Black"],
    sizes: ["S", "M", "L"],
  },
  {
    id: "white-soft-bra",
    name: "White Soft Comfort Bra",
    price: 380,
    image: "/images/white-soft-bra.png",
    colors: ["White"],
    sizes: ["75B", "80B", "85B", "90B", "95B"],
  },
  {
    id: "black-soft-bra",
    name: "Black Soft Comfort Bra",
    price: 380,
    image: "/images/black-soft-bra.png",
    colors: ["Black"],
    sizes: ["75B", "80B", "85B", "90B", "95B"],
  },
];
---

<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Amicbridge</title>

<style>
:root{--bg:#f7f6f4;--text:#151515;--muted:#6b6b6b;--border:#dedede;--card:#fff;}
body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;background:var(--bg);color:var(--text)}
header{padding:22px 40px;display:flex;justify-content:space-between;align-items:center}
main{max-width:1100px;margin:0 auto;padding:0 40px 70px}
a{text-decoration:none;color:var(--text)}
.grid{display:grid;grid-template-columns:repeat(3,1fr);gap:16px;margin-top:20px}
.card{background:#fff;border:1px solid var(--border);padding:14px;border-radius:12px}
img{width:100%;height:260px;object-fit:cover;border-radius:12px;border:1px solid var(--border)}
select,button{padding:10px;border-radius:10px;border:1px solid var(--border)}
button{background:#151515;color:#fff;font-weight:900;cursor:pointer}
.muted{color:var(--muted)}
@media(max-width:900px){main,header{padding:18px}.grid{grid-template-columns:1fr}}
</style>
</head>

<body>
<header>
  <div>
    <strong>Amicbridge</strong>
    <div class="muted">Satin-look sleepwear</div>
  </div>
  <a href={`${base}checkout/`}><strong>Checkout â†’</strong></a>
</header>

<main>
<h1>Shop</h1>
<div class="muted">Add to cart, pay with Vipps, we ship after payment.</div>

<!-- ðŸ”¹ VIPPS PAYMENT SECTION -->
<section style="margin-top:26px">
  <div class="card">
    <h2 style="margin-top:0">Pay with Vipps</h2>
    <div class="muted">
      Scan the QR code in Vipps. Then go to checkout and send your order details.
    </div>

    <div style="margin-top:10px;font-weight:900;font-size:18px">
      Vipps number: 92928373
    </div>

    <img
      src="/images/vipps-qr.jpg"
      alt="Vipps QR"
      style="width:260px;margin-top:12px"
    />

    <div style="margin-top:12px">
      <a
        href={`${base}checkout/`}
        style="display:inline-block;padding:12px 14px;background:#151515;color:#fff;border-radius:12px;font-weight:900"
      >
        Go to checkout
      </a>
    </div>
  </div>
</section>

<!-- ðŸ”¹ PRODUCTS -->
<div class="grid">
{products.map(p => (
  <div class="card" data-id={p.id} data-name={p.name} data-price={p.price}>
    <img src={img(p.image)} alt={p.name} />
    <strong>{p.name}</strong>
    <div class="muted">{p.price} NOK</div>

    <select class="size">
      {p.sizes.map(s => <option value={s}>{s}</option>)}
    </select>

    <select class="color">
      {p.colors.map(c => <option value={c}>{c}</option>)}
    </select>

    <button class="add" type="button">Add to cart</button>
  </div>
))}
</div>
</main>

<script>
function readCart(){return JSON.parse(localStorage.getItem("cart")||"[]")}
function writeCart(c){localStorage.setItem("cart",JSON.stringify(c))}

document.addEventListener("click",e=>{
  const btn=e.target.closest(".add");
  if(!btn)return;

  const card=btn.closest(".card");
  const item={
    id:card.dataset.id,
    name:card.dataset.name,
    price:Number(card.dataset.price),
    size:card.querySelector(".size").value,
    color:card.querySelector(".color").value,
    quantity:1
  };

  const cart=readCart();
  const ex=cart.find(i=>i.id===item.id&&i.size===item.size&&i.color===item.color);
  if(ex)ex.quantity+=1;
  else cart.push(item);

  writeCart(cart);
  btn.textContent="Added âœ“";
  setTimeout(()=>btn.textContent="Add to cart",900);
});
</script>
</body>
</html>
